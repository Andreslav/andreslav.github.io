<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>`</title>
	<script type="text/javascript" async="" src="/app.js"></script>
</head>
<body>
	
<!-- template core-app -->
<template id="core-app">
<transition name="fade" appear>
	<div id="core">
		<div 
			class="progress" 
			:style="{height: progress}"
		></div>
		<div class="top-menu content">
			<div v-if="position.length == 0">
				<span 
					class="top-menu__btn addToDO" 
					@click="addToDoList"
				>–î–æ–±–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</span>
				<span 
					class="top-menu__btn" 
					@click="deleteHecked" 
					:class="{disabled: lengthDeleteHecked == 0}"
					title="–£–¥–∞–ª–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏"
				>–£–¥–∞–ª–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏{{lengthDeleteHecked | surround}}</span>
			</div>
			<div v-else>
				<span 
					class="top-menu__btn top-menu__back" 
					@click="back"
				>ü†ú {{backName}}</span>
			</div>
			<div>
				<span 
					class="top-menu__btn top-menu__toggle-scheme" 
					@click="toggleScheme"
					:class="{dark: dark}" 
				>–¢–µ–º–∞: {{dark ? '–¢—ë–º–Ω–∞—è' : '–°–≤–µ—Ç–ª–∞—è'}}</span>
			</div>
		</div>
		
		<div 
			class="content" 
			v-if="lenghtTODOS == 0" 
		>–ó–∞–¥–∞—á –Ω–µ—Ç</div>
		<to-do-list 
			v-for="item in displayedToDoList" 
			:key="item.id" 
			:list="item.list" 
			:head="item.head" 
			:id="item.id"
		></to-do-list>
	</div>
</transition>
</template>


<!-- template to-do-list -->
<template id="to-do-list">
	<div 
		class="to-do-list content"
		:class="{fixed: fixed == id}" >
		<header class="to-do-list__header header-to-do">
			<div class="to-do-list__header__control">
				<div>
					<span 
						class="btn" 
						@click="deleteList" 
					>–£–¥–∞–ª–∏—Ç—å –ª–∏—Å—Ç</span>
					<span 
						class="btn"
						@click="deleteCheckedTask" 
						:class="{disabled: lengthCheckedTask == 0}" 
						title="–£–¥–∞–ª–∏—Ç—å –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏"
					>–£–¥–∞–ª–∏—Ç—å –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏{{lengthCheckedTask | surround}}</span>
					<span 
						class="btn" 
						@click="deleteAllTask" 
						:class="{disabled: list.length == 0}" 
						title="–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏"
					>–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏{{list.length | surround}}</span>
				</div>
				<div>
					<span 
						class="btn fixed" 
						@click="fixing" 
						title="–ó–∞–∫—Ä–µ–ø–∏—Ç—å"
					>üöÄ</span>
				</div>
			</div>
			<h2>
				<user-input 
					:value="head" 
					@change-value="changeValue" 
				></user-input>
			</h2>
		
			<div 
				class="header-to-do__new"
				:class="{disabled: this.newToDo == ''}">
				<div class="header-to-do__new__val">
					<input 
						type="text" 
						placeholder="–ù—É–∂–Ω–æ..." 
						@keyup.enter="addToDo" 
						v-model.trim="newToDo" 
				 	>
				</div>
				<div 
					class="header-to-do__new__add" 
					@click="addToDo" 
					:title="this.newToDo != '' ? 'Enter' : ''"
			 	>–î–æ–±–∞–≤–∏—Ç—å</div>
				<span 
					class="progress" 
					:style="{width: progress}"
				></span>
			</div>
		</header>
		
		<div 
			class="to-do-list__body list"
			@dragleave.prevent="onDragLeave" >
			<drag-item
				v-for="(item, index) in list" 
				v-if="index + 1 <= countVisible" 
				:key="item.id" 
				:class="{
					'drag-over': isDragOver(item.id), 
					top: drag–íirection == 1 && isDragOver(item.id), 
					bottom: drag–íirection == -1 && isDragOver(item.id), 
					draging: item.id == dragItem
				}" 
				@itemmoved="onItemMoved" 
				@itemdragover="onDragOver" 
				:task="item" 
				:listid="id" 
			></drag-item>
			<div 
				class="show-all" 
				v-if="list.length > countVisible" 
				@click="showAll" 
			>–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ</div>
		</div>
	</div>
</template>


<!-- template drag-item -->
<template id="drag-item">
<transition name="fade" appear>
	<div 
		:draggable="disabledInput" 
		@dragstart="onDragStart" 
		@dragover.prevent="upDragOver" 
		@drop.prevent="onDrop" >
		<to-do-list-item 
			v-if="task.type == 'task'" 
			:value="task.value" 
			:checked="task.checked" 
			:id="task.id" 
			:listid="listid" 
			@disabled-input="disabledInput = $event" 
		></to-do-list-item>
		<to-do-list-item_link 
			v-else-if="task.type == 'link'" 
			:value="task.value" 
			:checked="task.checked" 
			:link="task.link" 
			:id="task.id" 
			:listid="listid" 
			@disabled-input="disabledInput = $event" 
		></to-do-list-item_link>
	</div>
</transition>
</template>


<!-- template to-do-list-item -->
<template id="to-do-list-item">
	<div 
		class="list__to-do" 
		:class="{completed: checked}">
		<div 
			class="list__to-do__status" 
			@click="toggleStatus"
	 	></div>
		<div 
			class="list__to-do__value">
			<user-input 
				:value.trim="value" 
				@click="toggleStatus" 
				@remove="deleteItem" 
				@change-value="changeValue" 
				@disabled-input="$emit('disabled-input', $event)" 
				:id="id" 
				placeholder="–ï—â—ë –æ–¥–Ω–æ —Ç–∞–∫–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –∏ —è —É–¥–∞–ª—é—Å—å..."
			></user-input>
		</div>
		<div class="list__to-do__menu">
			<div class="list__to-do__popup hidden">
				<div class="item" @click="deleteItem">–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É</div>
				<div class="item" @click="toList">–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —Å–∫—Ä—ã—Ç—ã–π —Å–ø–∏—Å–æ–∫</div>
				<div class="item" @click="toToDo">–°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫</div>
			</div>
		</div>
	</div>
</template>


<!-- template to-do-list-item_link -->
<template id="to-do-list-item_link">
	<div 
		class="list__to-do link" 
		:class="{completed: checked}" >
		<div 
			class="list__to-do__status" 
			@click="go"
	 	></div>
		<div 
			class="list__to-do__value">
			<user-input 
				:value.trim="value" 
				@click="go" 
				@remove="deleteLink" 
				@change-value="changeValue" 
				@disabled-input="$emit('disabled-input', $event)" 
				:id="id" 
			></user-input>
		</div>
		<div class="list__to-do__menu">
			<div class="list__to-do__popup hidden">
				<div class="item" @click="deleteLink">–£–¥–∞–ª–∏—Ç—å —Å–∫—Ä—ã—Ç—ã–π —Å–ø–∏—Å–æ–∫</div>
				<div class="item" @click="toTask">–†–∞—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä—ã—Ç—ã–π —Å–ø–∏—Å–æ–∫</div>
				<div class="item" @click="toToDo">–°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫</div>
			</div>
		</div>
	</div>
</template>


<!-- template user-input -->
<template id="user-input">
	<div 
		class="user-input" 
		:class="{edit: !disabled, 'visibility-placeholder': visibilityPlaceholder}" 
	 	@click="edit" 
		@blur="blur" 
		@keydown.enter="disabled = true" 
	 	@keydown.delete="remove" 
		@keydown="onKeydown" 
		:contentEditable="!disabled" 
		:title="disabled ? 'dblclick' : ''" 
	>{{value}}</div>
</template>


<!-- app -->
<div id="app">
	<core-app></core-app>
</div>
</body>
</html>
